---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "doit_alert Resource - terraform-provider-doit"
subcategory: ""
description: |-
  Notifications triggered when cloud costs exceed defined thresholds or meet specific conditions.
---

# doit_alert (Resource)

Notifications triggered when cloud costs exceed defined thresholds or meet specific conditions.

## Example Usage

```terraform
# Use doit_current_user to dynamically get the current user's email
# for alert recipients instead of hardcoding email addresses
data "doit_current_user" "me" {}

# Create an alert that triggers when costs exceed $1000 per month
resource "doit_alert" "cost_alert" {
  name = "Monthly Cost Alert"
  config = {
    metric = {
      type  = "basic"
      value = "cost"
    }
    time_interval = "month"
    value         = 1000
    currency      = "USD"
    condition     = "value"
    operator      = "gt"
  }
  recipients = [data.doit_current_user.me.email]
}

# Alert with scope filters
resource "doit_alert" "aws_cost_alert" {
  name = "AWS Cost Alert"
  config = {
    metric = {
      type  = "basic"
      value = "cost"
    }
    time_interval = "day"
    value         = 100
    currency      = "USD"
    condition     = "value"
    operator      = "gt"
    scopes = [
      {
        type   = "fixed"
        id     = "cloud_provider"
        mode   = "is"
        values = ["amazon-web-services"]
      }
    ]
  }
  recipients = [data.doit_current_user.me.email]
}

# ─────────────────────────────────────────────────────────────────────────────
# Discovering valid scope values using data sources
# ─────────────────────────────────────────────────────────────────────────────
# Alert scopes use the same id/type/mode/values structure as report filters.
# Use doit_products, doit_dimensions, and doit_users to populate these dynamically.

# Use doit_products to scope an alert to specific cloud services
data "doit_products" "gcp" {
  platform = "google_cloud_platform"
}

resource "doit_alert" "gcp_compute_cost_alert" {
  name = "GCP Compute Cost Alert"
  config = {
    metric = {
      type  = "basic"
      value = "cost"
    }
    time_interval = "day"
    value         = 500
    currency      = "USD"
    condition     = "value"
    operator      = "gt"
    # Use product IDs from the data source as scope filter values
    scopes = [
      {
        type   = "fixed"
        id     = "service_description"
        mode   = "is"
        values = [for p in data.doit_products.gcp.products : p.id if p.display_name == "Compute Engine"]
      }
    ]
  }
  recipients = [data.doit_current_user.me.email]
}

# Use doit_dimensions to look up correct dimension types for scope fields
data "doit_dimensions" "all" {}

locals {
  dimension_types = { for id, types in {
    for d in data.doit_dimensions.all.dimensions : d.id => d.type...
  } : id => types[0] }
}

resource "doit_alert" "region_cost_alert" {
  name = "Region Cost Alert"
  config = {
    metric = {
      type  = "basic"
      value = "cost"
    }
    time_interval = "month"
    value         = 5000
    currency      = "USD"
    condition     = "value"
    operator      = "gt"
    # Use the dimension lookup to get the correct type for each scope field
    scopes = [
      {
        id     = "region"
        type   = local.dimension_types["region"]
        mode   = "is"
        values = ["us-east1", "us-central1"]
      }
    ]
  }
  recipients = [data.doit_current_user.me.email]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `config` (Attributes) Parameters that define when and how an alert is evaluated. (see [below for nested schema](#nestedatt--config))
- `name` (String) Name of the alert.

### Optional

- `recipients` (List of String) List of emails to notify when the alert is triggered.

### Read-Only

- `create_time` (Number) The time when the alert was created (in UNIX timestamp).
- `id` (String) Alert ID.
- `last_alerted` (Number) Last time the alert was triggered (in UNIX timestamp).
- `update_time` (Number) Last time the alert was modified (in UNIX timestamp).

<a id="nestedatt--config"></a>
### Nested Schema for `config`

Required:

- `metric` (Attributes) Define how metrics are selected and filtered in reports. (see [below for nested schema](#nestedatt--config--metric))
- `value` (Number)

Optional:

- `attributions` (List of String, Deprecated) Use 'scopes' instead. The attributions selected define the scope to monitor.
- `condition` (String) Condition key or expression used in alert configurations.
- `currency` (String) Currency code for monetary values.
Possible values: `USD`, `ILS`, `EUR`, `AUD`, `CAD`, `GBP`, `DKK`, `NOK`, `SEK`, `BRL`, `SGD`, `MXN`, `CHF`, `MYR`, `TWD`, `EGP`, `ZAR`, `JPY`, `IDR`, `AED`, `THB`, `COP`
- `data_source` (String)
- `evaluate_for_each` (String) Add a dimension to break down the evaluation of the condition. For example, evaluate a condition over an attribution for each "Service".
- `operator` (String) Text/operator used to filter metric values in metric filters.
Possible values: `gt`, `lt`
- `scopes` (Attributes List) The filters selected define the scope of the alert. (see [below for nested schema](#nestedatt--config--scopes))
- `time_interval` (String) The time interval to evaluate the condition.
Possible values: `hour`, `day`, `week`, `month`, `quarter`, `year`

<a id="nestedatt--config--metric"></a>
### Nested Schema for `config.metric`

Required:

- `type` (String) Identifier for metric type (e.g., basic, custom, extended).
- `value` (String)


<a id="nestedatt--config--scopes"></a>
### Nested Schema for `config.scopes`

Required:

- `id` (String) The field to filter on
- `mode` (String) Filter mode to apply
Possible values: `is`, `starts_with`, `ends_with`, `contains`, `regexp`
- `type` (String) Enumeration of supported dimension/filter types.
Possible values: `datetime`, `fixed`, `optional`, `label`, `tag`, `project_label`, `system_label`, `attribution`, `attribution_group`, `gke`, `gke_label`

Optional:

- `inverse` (Boolean) Set to `true` to exclude the values.
- `values` (List of String) Values to filter on.

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
terraform import doit_alert.alert [id]
```
