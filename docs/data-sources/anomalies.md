---
page_title: "doit_anomalies Data Source - terraform-provider-doit"
subcategory: ""
description: |-
  Monitor cost spikes in your cloud environment.
---

# doit_anomalies (Data Source)

Monitor cost spikes in your cloud environment.

## Example Usage

```terraform
# Retrieve all anomalies
data "doit_anomalies" "all" {}

# Filter by severity
data "doit_anomalies" "critical" {
  filter = "severityLevel:critical"
}

# Output anomaly details
output "total_anomalies" {
  value = data.doit_anomalies.all.row_count
}

output "anomaly_summary" {
  value = [for a in data.doit_anomalies.all.anomalies : {
    id          = a.id
    service     = a.service_name
    cost_impact = a.cost_of_anomaly
    severity    = a.severity_level
    status      = a.status
  }]
}

# ─────────────────────────────────────────────────────────────────────────────
# Combining data sources: enrich anomalies with product and platform info
# ─────────────────────────────────────────────────────────────────────────────

# Use doit_platforms to discover available platforms
data "doit_platforms" "all" {}

# Group anomalies by platform
output "anomalies_by_platform" {
  description = "Cost anomalies grouped by cloud platform"
  value = {
    for p in data.doit_platforms.all.platforms : p.display_name => [
      for a in data.doit_anomalies.all.anomalies : {
        id          = a.id
        service     = a.service_name
        cost_impact = a.cost_of_anomaly
        severity    = a.severity_level
      } if a.platform == p.display_name
      ] if length([
        for a in data.doit_anomalies.all.anomalies : a if a.platform == p.display_name
    ]) > 0
  }
}

# Use doit_products to cross-reference anomaly services with known products
data "doit_products" "all" {}

output "anomalies_with_product_match" {
  description = "Anomalies enriched with whether their service matches a known product"
  value = [for a in data.doit_anomalies.all.anomalies : {
    id            = a.id
    service       = a.service_name
    platform      = a.platform
    cost_impact   = a.cost_of_anomaly
    severity      = a.severity_level
    known_product = contains([for p in data.doit_products.all.products : p.display_name], a.service_name)
  }]
}
```

-> For details on auto and manual pagination, see the [Pagination Guide](../guides/pagination).

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `filter` (String) An expression for filtering the results of the request
- `max_creation_time` (String) Max value for the anomaly detection time
- `max_results` (Number) The maximum number of results to return in a single page
- `min_creation_time` (String) Min value for the anomaly detection time
- `page_token` (String) Page token, returned by a previous call, to request the next page of results

### Read-Only

- `anomalies` (Attributes List) (see [below for nested schema](#nestedatt--anomalies))
- `row_count` (Number)

<a id="nestedatt--anomalies"></a>
### Nested Schema for `anomalies`

Read-Only:

- `acknowledged` (Boolean) Has the anomaly been acknowledged
- `attribution` (String) Attribution ID.
- `billing_account` (String) Billing account ID.
- `cost_of_anomaly` (Number) Cost of the anomaly over and above the expected normal cost.
- `end_time` (Number) End of the anomaly.
- `id` (String)
- `platform` (String) Cloud Provider name.
- `resource_data` (Attributes List) Array of resources contributing to an anomaly. (see [below for nested schema](#nestedatt--anomalies--resource_data))
- `scope` (String) Scope: Project or Account
- `service_name` (String) Service name.
- `severity_level` (String) Severity level: Information, Warning or Critical
- `start_time` (Number) Usage start time of the anomaly.
- `status` (String)
- `time_frame` (String) Timeframe: Daily or Hourly
- `top3skus` (Attributes List) Array of SKU entries contributing to an anomaly. (see [below for nested schema](#nestedatt--anomalies--top3skus))

<a id="nestedatt--anomalies--resource_data"></a>
### Nested Schema for `anomalies.resource_data`

Read-Only:

- `cost` (Number)
- `operation` (String) For anomalies related to AWS S3
- `resource_id` (String)
- `sku_description` (String)


<a id="nestedatt--anomalies--top3skus"></a>
### Nested Schema for `anomalies.top3skus`

Read-Only:

- `cost` (Number)
- `name` (String)
